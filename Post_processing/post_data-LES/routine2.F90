	SUBROUTINE ROUTINE2
	
	USE COMDAT_SHARED
	
	IMPLICIT NONE
	SAVE
	
	!	VORTICAL STRUCTURE

	DO M=1,NFRAME2
	
	DO RANK=0,NPRC-1
	
	FILENAME = 'VOR_0000_00.PLT'
	
	WRITE(FILENAME(5:8),'(I4.4)') INT(M)
	
	WRITE(FILENAME(10:11),'(I2.2)') INT(RANK)
	
	OPEN(UNIT=100,FILE=FILENAME,STATUS='OLD')
		READ(100,*)	!CHARACTER1
		READ(100,*) !CHARACTER2
		READ(100,*) !CHARACTER3
		DO K=KS(RANK)+1,KE(RANK)
		DO J=JS(RANK)+1,JE(RANK)
		DO I=IS(RANK)+1,IE(RANK)
			READ(100,*) X(I,J,K),Y(I,J,K),Z(I,J,K),V1(I,J,K),V2(I,J,K)
		ENDDO
		ENDDO
		ENDDO
	CLOSE(100)
	
	ENDDO	! RANK-LOOP
	
	FILENAME2 = 'Structure_000.dat'
	
	WRITE(FILENAME2(11:13),'(I3.3)') INT(M)
	
	OPEN(UNIT=100,FILE=FILENAME2,STATUS='UNKNOWN')
	WRITE(100,*) 'TITLE="Vortical_Structure"'
	WRITE(100,*) 'variables=x,y,z,vorM,lamda'
	WRITE(100,31) NI,NJ,NK
31	FORMAT(TR1,'ZONE T="POST", I=',I6,', J=',I6,', K=',I6)
	DO K=1,NK
    DO J=1,NJ
    DO I=1,NI
		WRITE(100,32) X(I,J,K),Y(I,J,K),Z(I,J,K),V1(I,J,K),V2(I,J,K)
32		FORMAT(TR1,D16.9,TR1,D16.9,TR1,D16.9,TR1,D16.9,TR1,D16.9)
	ENDDO
	ENDDO
	ENDDO
	CLOSE(100)
	
	PRINT *,M

	ENDDO	! M-LOOP

	END SUBROUTINE ROUTINE2