	SUBROUTINE DIF(IN,OUT)

	USE COMDAT_SHARED 
      
	IMPLICIT NONE
    SAVE
!------------------------------------------------------------
!   DEFINE ARGUMENT VARIABLES
!------------------------------------------------------------
	DOUBLE PRECISION, INTENT(IN)  :: IN(SX:EX,SY:EY,SZ:EZ)
	DOUBLE PRECISION, INTENT(OUT) :: OUT(SX:EX,SY:EY,SZ:EZ)
        
    CALL DIF_DIAGONAL(IN,DD)
    
	OUT(SX1:EX1,SY1:EY1,SZ1:EZ1)=1.0D0/RE															&
		*(DE(SX1:EX1,SY1:EY1,SZ1:EZ1)*(IN(SX1+1:EX1+1,SY1:EY1,SZ1:EZ1)-IN(SX1:EX1,SY1:EY1,SZ1:EZ1)) &
		+ DW(SX1:EX1,SY1:EY1,SZ1:EZ1)*(IN(SX1-1:EX1-1,SY1:EY1,SZ1:EZ1)-IN(SX1:EX1,SY1:EY1,SZ1:EZ1)) &
		+ DN(SX1:EX1,SY1:EY1,SZ1:EZ1)*(IN(SX1:EX1,SY1+1:EY1+1,SZ1:EZ1)-IN(SX1:EX1,SY1:EY1,SZ1:EZ1)) &
		+ DS(SX1:EX1,SY1:EY1,SZ1:EZ1)*(IN(SX1:EX1,SY1-1:EY1-1,SZ1:EZ1)-IN(SX1:EX1,SY1:EY1,SZ1:EZ1)) &
		+ DT(SX1:EX1,SY1:EY1,SZ1:EZ1)*(IN(SX1:EX1,SY1:EY1,SZ1+1:EZ1+1)-IN(SX1:EX1,SY1:EY1,SZ1:EZ1)) &
		+ DB(SX1:EX1,SY1:EY1,SZ1:EZ1)*(IN(SX1:EX1,SY1:EY1,SZ1-1:EZ1-1)-IN(SX1:EX1,SY1:EY1,SZ1:EZ1))	&
		)																							&
		+DD

	END SUBROUTINE DIF