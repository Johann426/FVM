    SUBROUTINE DIF_DIAGONAL(INN,OUT)
    
    USE COMDAT_SHARED
    
    IMPLICIT NONE
    SAVE
!------------------------------------------------------------
!   Define Argument variables
!------------------------------------------------------------
	DOUBLE PRECISION, INTENT(IN)  :: INN(SX:EX,SY:EY,SZ:EZ)
	DOUBLE PRECISION, INTENT(OUT) :: OUT(SX:EX,SY:EY,SZ:EZ)
    
    OUT(SX1:EX1,SY1:EY1,SZ1:EZ1) = 0.25D0/DJAC(SX1:EX1,SY1:EY1,SZ1:EZ1)*	&
    (																																				&
	+Q12(SX1+1:EX1+1,SY1:EY1,SZ1:EZ1)*DJAC(SX1+1:EX1+1,SY1:EY1,SZ1:EZ1)*(INN(SX1+1:EX1+1,SY1+1:EY1+1,SZ1:EZ1)-INN(SX1+1:EX1+1,SY1-1:EY1-1,SZ1:EZ1))	&
	-Q12(SX1-1:EX1-1,SY1:EY1,SZ1:EZ1)*DJAC(SX1-1:EX1-1,SY1:EY1,SZ1:EZ1)*(INN(SX1-1:EX1-1,SY1+1:EY1+1,SZ1:EZ1)-INN(SX1-1:EX1-1,SY1-1:EY1-1,SZ1:EZ1))	&
	
	+Q13(SX1+1:EX1+1,SY1:EY1,SZ1:EZ1)*DJAC(SX1+1:EX1+1,SY1:EY1,SZ1:EZ1)*(INN(SX1+1:EX1+1,SY1:EY1,SZ1+1:EZ1+1)-INN(SX1+1:EX1+1,SY1:EY1,SZ1-1:EZ1-1))	&
	-Q13(SX1-1:EX1-1,SY1:EY1,SZ1:EZ1)*DJAC(SX1-1:EX1-1,SY1:EY1,SZ1:EZ1)*(INN(SX1-1:EX1-1,SY1:EY1,SZ1+1:EZ1+1)-INN(SX1-1:EX1-1,SY1:EY1,SZ1-1:EZ1-1))	&

	+Q21(SX1:EX1,SY1+1:EY1+1,SZ1:EZ1)*DJAC(SX1:EX1,SY1+1:EY1+1,SZ1:EZ1)*(INN(SX1+1:EX1+1,SY1+1:EY1+1,SZ1:EZ1)-INN(SX1-1:EX1-1,SY1+1:EY1+1,SZ1:EZ1))	&
	-Q21(SX1:EX1,SY1-1:EY1-1,SZ1:EZ1)*DJAC(SX1:EX1,SY1-1:EY1-1,SZ1:EZ1)*(INN(SX1+1:EX1+1,SY1-1:EY1-1,SZ1:EZ1)-INN(SX1-1:EX1-1,SY1-1:EY1-1,SZ1:EZ1))	&
	
	+Q23(SX1:EX1,SY1+1:EY1+1,SZ1:EZ1)*DJAC(SX1:EX1,SY1+1:EY1+1,SZ1:EZ1)*(INN(SX1:EX1,SY1+1:EY1+1,SZ1+1:EZ1+1)-INN(SX1:EX1,SY1+1:EY1+1,SZ1-1:EZ1-1))	&
	-Q23(SX1:EX1,SY1-1:EY1-1,SZ1:EZ1)*DJAC(SX1:EX1,SY1-1:EY1-1,SZ1:EZ1)*(INN(SX1:EX1,SY1-1:EY1-1,SZ1+1:EZ1+1)-INN(SX1:EX1,SY1-1:EY1-1,SZ1-1:EZ1-1))	&

	+Q31(SX1:EX1,SY1:EY1,SZ1+1:EZ1+1)*DJAC(SX1:EX1,SY1:EY1,SZ1+1:EZ1+1)*(INN(SX1+1:EX1+1,SY1:EY1,SZ1+1:EZ1+1)-INN(SX1-1:EX1-1,SY1:EY1,SZ1+1:EZ1+1))	&
	-Q31(SX1:EX1,SY1:EY1,SZ1-1:EZ1-1)*DJAC(SX1:EX1,SY1:EY1,SZ1-1:EZ1-1)*(INN(SX1+1:EX1+1,SY1:EY1,SZ1-1:EZ1-1)-INN(SX1-1:EX1-1,SY1:EY1,SZ1-1:EZ1-1))	&
	
	+Q32(SX1:EX1,SY1:EY1,SZ1+1:EZ1+1)*DJAC(SX1:EX1,SY1:EY1,SZ1+1:EZ1+1)*(INN(SX1:EX1,SY1+1:EY1+1,SZ1+1:EZ1+1)-INN(SX1:EX1,SY1-1:EY1-1,SZ1+1:EZ1+1))	&
	-Q32(SX1:EX1,SY1:EY1,SZ1-1:EZ1-1)*DJAC(SX1:EX1,SY1:EY1,SZ1-1:EZ1-1)*(INN(SX1:EX1,SY1+1:EY1+1,SZ1-1:EZ1-1)-INN(SX1:EX1,SY1-1:EY1-1,SZ1-1:EZ1-1))	&
    )
	
    END SUBROUTINE DIF_DIAGONAL