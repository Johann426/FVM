    SUBROUTINE NL(IN,OUT)
    
    USE COMDAT_SHARED
    
    IMPLICIT NONE
    SAVE
!------------------------------------------------------------
!   Define Argument variables
!------------------------------------------------------------
   	DOUBLE PRECISION, INTENT(IN)  :: IN(IS:IE,JS:JE,KS:KE)
	DOUBLE PRECISION, INTENT(OUT) :: OUT(IS:IE,JS:JE,KS:KE)

    OUT(IS1:IE1,JS1:JE1,KS1:KE1)=0.5D0*																	&
	(																									&
    +DJAC(IS1+1:IE1+1,JS1:JE1,KS1:KE1)*U1(IS1+1:IE1+1,JS1:JE1,KS1:KE1)*IN(IS1+1:IE1+1,JS1:JE1,KS1:KE1)	&
	-DJAC(IS1-1:IE1-1,JS1:JE1,KS1:KE1)*U1(IS1-1:IE1-1,JS1:JE1,KS1:KE1)*IN(IS1-1:IE1-1,JS1:JE1,KS1:KE1)	&
	+DJAC(IS1:IE1,JS1+1:JE1+1,KS1:KE1)*U2(IS1:IE1,JS1+1:JE1+1,KS1:KE1)*IN(IS1:IE1,JS1+1:JE1+1,KS1:KE1)	&
	-DJAC(IS1:IE1,JS1-1:JE1-1,KS1:KE1)*U2(IS1:IE1,JS1-1:JE1-1,KS1:KE1)*IN(IS1:IE1,JS1-1:JE1-1,KS1:KE1)	&
	+DJAC(IS1:IE1,JS1:JE1,KS1+1:KE1+1)*U3(IS1:IE1,JS1:JE1,KS1+1:KE1+1)*IN(IS1:IE1,JS1:JE1,KS1+1:KE1+1)	&
	-DJAC(IS1:IE1,JS1:JE1,KS1-1:KE1-1)*U3(IS1:IE1,JS1:JE1,KS1-1:KE1-1)*IN(IS1:IE1,JS1:JE1,KS1-1:KE1-1)	&
	)
    END SUBROUTINE NL