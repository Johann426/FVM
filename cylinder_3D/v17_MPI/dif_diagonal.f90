    SUBROUTINE DIF_DIAGONAL(INN,OUT)
    
    USE COMDAT_SHARED
    
    IMPLICIT NONE
    SAVE
!------------------------------------------------------------
!   Define Argument variables
!------------------------------------------------------------
	DOUBLE PRECISION, INTENT(IN)  :: INN(IS:IE,JS:JE,KS:KE)
	DOUBLE PRECISION, INTENT(OUT) :: OUT(IS:IE,JS:JE,KS:KE)
    
    OUT(IS1:IE1,JS1:JE1,KS1:KE1) = 0.25D0/DJAC(IS1:IE1,JS1:JE1,KS1:KE1)*	&
    (																																				&
	+Q12(IS1+1:IE1+1,JS1:JE1,KS1:KE1)*DJAC(IS1+1:IE1+1,JS1:JE1,KS1:KE1)*(INN(IS1+1:IE1+1,JS1+1:JE1+1,KS1:KE1)-INN(IS1+1:IE1+1,JS1-1:JE1-1,KS1:KE1))	&
	-Q12(IS1-1:IE1-1,JS1:JE1,KS1:KE1)*DJAC(IS1-1:IE1-1,JS1:JE1,KS1:KE1)*(INN(IS1-1:IE1-1,JS1+1:JE1+1,KS1:KE1)-INN(IS1-1:IE1-1,JS1-1:JE1-1,KS1:KE1))	&
	
	+Q13(IS1+1:IE1+1,JS1:JE1,KS1:KE1)*DJAC(IS1+1:IE1+1,JS1:JE1,KS1:KE1)*(INN(IS1+1:IE1+1,JS1:JE1,KS1+1:KE1+1)-INN(IS1+1:IE1+1,JS1:JE1,KS1-1:KE1-1))	&
	-Q13(IS1-1:IE1-1,JS1:JE1,KS1:KE1)*DJAC(IS1-1:IE1-1,JS1:JE1,KS1:KE1)*(INN(IS1-1:IE1-1,JS1:JE1,KS1+1:KE1+1)-INN(IS1-1:IE1-1,JS1:JE1,KS1-1:KE1-1))	&

	+Q21(IS1:IE1,JS1+1:JE1+1,KS1:KE1)*DJAC(IS1:IE1,JS1+1:JE1+1,KS1:KE1)*(INN(IS1+1:IE1+1,JS1+1:JE1+1,KS1:KE1)-INN(IS1-1:IE1-1,JS1+1:JE1+1,KS1:KE1))	&
	-Q21(IS1:IE1,JS1-1:JE1-1,KS1:KE1)*DJAC(IS1:IE1,JS1-1:JE1-1,KS1:KE1)*(INN(IS1+1:IE1+1,JS1-1:JE1-1,KS1:KE1)-INN(IS1-1:IE1-1,JS1-1:JE1-1,KS1:KE1))	&
	
	+Q23(IS1:IE1,JS1+1:JE1+1,KS1:KE1)*DJAC(IS1:IE1,JS1+1:JE1+1,KS1:KE1)*(INN(IS1:IE1,JS1+1:JE1+1,KS1+1:KE1+1)-INN(IS1:IE1,JS1+1:JE1+1,KS1-1:KE1-1))	&
	-Q23(IS1:IE1,JS1-1:JE1-1,KS1:KE1)*DJAC(IS1:IE1,JS1-1:JE1-1,KS1:KE1)*(INN(IS1:IE1,JS1-1:JE1-1,KS1+1:KE1+1)-INN(IS1:IE1,JS1-1:JE1-1,KS1-1:KE1-1))	&

	+Q31(IS1:IE1,JS1:JE1,KS1+1:KE1+1)*DJAC(IS1:IE1,JS1:JE1,KS1+1:KE1+1)*(INN(IS1+1:IE1+1,JS1:JE1,KS1+1:KE1+1)-INN(IS1-1:IE1-1,JS1:JE1,KS1+1:KE1+1))	&
	-Q31(IS1:IE1,JS1:JE1,KS1-1:KE1-1)*DJAC(IS1:IE1,JS1:JE1,KS1-1:KE1-1)*(INN(IS1+1:IE1+1,JS1:JE1,KS1-1:KE1-1)-INN(IS1-1:IE1-1,JS1:JE1,KS1-1:KE1-1))	&
	
	+Q32(IS1:IE1,JS1:JE1,KS1+1:KE1+1)*DJAC(IS1:IE1,JS1:JE1,KS1+1:KE1+1)*(INN(IS1:IE1,JS1+1:JE1+1,KS1+1:KE1+1)-INN(IS1:IE1,JS1-1:JE1-1,KS1+1:KE1+1))	&
	-Q32(IS1:IE1,JS1:JE1,KS1-1:KE1-1)*DJAC(IS1:IE1,JS1:JE1,KS1-1:KE1-1)*(INN(IS1:IE1,JS1+1:JE1+1,KS1-1:KE1-1)-INN(IS1:IE1,JS1-1:JE1-1,KS1-1:KE1-1))	&
    )
	
    END SUBROUTINE DIF_DIAGONAL