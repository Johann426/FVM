	SUBROUTINE DIF(IN,OUT)

	USE COMDAT_SHARED 
      
	IMPLICIT NONE
    SAVE
!------------------------------------------------------------
!   DEFINE ARGUMENT VARIABLES
!------------------------------------------------------------
	DOUBLE PRECISION, INTENT(IN)  :: IN(IS:IE,JS:JE,KS:KE)
	DOUBLE PRECISION, INTENT(OUT) :: OUT(IS:IE,JS:JE,KS:KE)
        
    CALL DIF_DIAGONAL(IN,DD)
    
	OUT(IS1:IE1,JS1:JE1,KS1:KE1)=1.0D0/RE															&
		*(AE(IS1:IE1,JS1:JE1,KS1:KE1)*(IN(IS1+1:IE1+1,JS1:JE1,KS1:KE1)-IN(IS1:IE1,JS1:JE1,KS1:KE1)) &
		+ AW(IS1:IE1,JS1:JE1,KS1:KE1)*(IN(IS1-1:IE1-1,JS1:JE1,KS1:KE1)-IN(IS1:IE1,JS1:JE1,KS1:KE1)) &
		+ AN(IS1:IE1,JS1:JE1,KS1:KE1)*(IN(IS1:IE1,JS1+1:JE1+1,KS1:KE1)-IN(IS1:IE1,JS1:JE1,KS1:KE1)) &
		+ AS(IS1:IE1,JS1:JE1,KS1:KE1)*(IN(IS1:IE1,JS1-1:JE1-1,KS1:KE1)-IN(IS1:IE1,JS1:JE1,KS1:KE1)) &
		+ AT(IS1:IE1,JS1:JE1,KS1:KE1)*(IN(IS1:IE1,JS1:JE1,KS1+1:KE1+1)-IN(IS1:IE1,JS1:JE1,KS1:KE1)) &
		+ AB(IS1:IE1,JS1:JE1,KS1:KE1)*(IN(IS1:IE1,JS1:JE1,KS1-1:KE1-1)-IN(IS1:IE1,JS1:JE1,KS1:KE1))	&
		)																							&
		+DD(IS1:IE1,JS1:JE1,KS1:KE1)

	END SUBROUTINE DIF